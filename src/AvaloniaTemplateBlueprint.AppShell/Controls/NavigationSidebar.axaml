<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:AvaloniaTemplateBlueprint.AppShell.ViewModels"
             mc:Ignorable="d" d:DesignWidth="250" d:DesignHeight="450"
             x:Class="AvaloniaTemplateBlueprint.AppShell.Controls.NavigationSidebar"
             x:DataType="vm:NavigatorItemViewModel">

    <UserControl.Styles>
        <Style Selector="TreeViewItem">
            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
        </Style>
        <Style Selector="TreeViewItem:selected /template/ Border#PART_LayoutRoot">
            <Setter Property="Background" Value="{DynamicResource SystemAccentColorLight2}"/>
        </Style>
    </UserControl.Styles>

    <Border Background="{DynamicResource SystemControlBackgroundAltMediumLowBrush}"
            BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
            BorderThickness="0,0,1,0"
            MinWidth="200">
        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Header -->
            <Border Grid.Row="0" Padding="12,8"
                    Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
                <TextBlock Text="Navigation"
                           FontWeight="SemiBold"
                           FontSize="14"/>
            </Border>

            <!-- Navigation Tree -->
            <TreeView Grid.Row="1"
                      Name="NavigationTree"
                      ItemsSource="{Binding Items}"
                      SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                      Margin="4">
                <TreeView.ItemTemplate>
                    <TreeDataTemplate ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal" Spacing="8" Margin="2">
                            <!-- Icon placeholder - replace with your icon system -->
                            <Border Width="20" Height="20"
                                    CornerRadius="4"
                                    Background="{DynamicResource SystemAccentColorLight3}"
                                    IsVisible="{Binding IconKey, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                <TextBlock Text="â€¢"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="{Binding Title}"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </TreeDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>

            <!-- Footer (optional) -->
            <Border Grid.Row="2" Padding="8"
                    Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                    IsVisible="False">
                <Button Content="Settings" HorizontalAlignment="Stretch"/>
            </Border>
        </Grid>
    </Border>
</UserControl>
